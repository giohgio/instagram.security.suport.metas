<script type="module">
    // 1️⃣ Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

    // 2️⃣ Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAQi__KXTsZQO9pCDcfTaHHD1q-lxojyDw",
      authDomain: "karol-51c2a.firebaseapp.com",
      projectId: "karol-51c2a",
      storageBucket: "karol-51c2a.firebasestorage.app",
      messagingSenderId: "972749971181",
      appId: "1:972749971181:web:2097b53d4cb707ddbab6e4",
      measurementId: "G-YSC432PYQY"
    };

    // 3️⃣ Inicializa Firebase e Firestore
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // 4️⃣ Função para mostrar mensagem
    function showMessage(text, type) {
      let msgBox = document.getElementById("msg-box");
      if (!msgBox) {
        msgBox = document.createElement("div");
        msgBox.id = "msg-box";
        msgBox.style.position = "fixed";
        msgBox.style.top = "10px";
        msgBox.style.left = "50%";
        msgBox.style.transform = "translateX(-50%)";
        msgBox.style.padding = "10px 20px";
        msgBox.style.borderRadius = "6px";
        msgBox.style.fontWeight = "bold";
        msgBox.style.zIndex = "9999";
        document.body.appendChild(msgBox);
      }

      msgBox.textContent = text;
      msgBox.style.backgroundColor = type === "success" ? "#4caf50" : "#f44336";
      msgBox.style.color = "#fff";

      setTimeout(() => {
        msgBox.remove();
      }, 3000);
    }

    // 5️⃣ Evento do botão
    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("send");

      btn.addEventListener("click", async () => {
        const email = document.querySelector("input[name='email']").value.trim();
        const comentario = document.querySelector("input[name='comentario']").value.trim();

        if (!email || !comentario) {
          showMessage("Preencha todos os campos!", "error");
          return;
        }

        try {
          // 6️⃣ Salva no Firestore na coleção "comentarios"
          await addDoc(collection(db, "comentarios"), {
            email,
            comentario,
            criadoEm: new Date()
          });

          showMessage("Atualizado com sucesso!", "success");

        } catch (err) {
          console.error("Erro ao salvar no Firebase:", err);
          showMessage("Falha ao salvar!", "error");
        }
      });
    });
  </script>
</body>
</html>
